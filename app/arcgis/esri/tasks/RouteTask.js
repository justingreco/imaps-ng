//>>built
define("esri/tasks/RouteTask","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../request ../geometry/normalizeUtils ./Task ./RouteResult ./NAMessage ./NAServiceDescription".split(" "),function(e,g,m,n,p,z,q,r,A,B,C,D){e=e([A,D],{declaredClass:"esri.tasks.RouteTask",_eventMap:{"solve-complete":["result"]},constructor:function(a){this._url.orig=this._url.path;this._url.path+="/solve";this._handler=g.hitch(this,this._handler);this.registerConnectEvents()},__msigns:[{n:"solve",
c:3,a:[{i:0,p:["stops.features","barriers.features","polylineBarriers.features","polygonBarriers.features"]}],e:2}],_handler:function(a,e,l,h,k){try{var d=[],b=[],E=a.routes?a.routes.features:[],t=a.stops?a.stops.features:[],g=a.barriers?a.barriers.features:[],n=a.polygonBarriers?a.polygonBarriers.features:[],p=a.polylineBarriers?a.polylineBarriers.features:[],s=a.messages,f=m.forEach,u=m.indexOf,v=!0,c,w,x=a.routes&&a.routes.spatialReference||a.stops&&a.stops.spatialReference||a.barriers&&a.barriers.spatialReference||
a.polygonBarriers&&a.polygonBarriers.spatialReference||a.polylineBarriers&&a.polylineBarriers.spatialReference;f(a.directions||[],function(a){d.push(c=a.routeName);b[c]={directions:a}});f(E,function(a){if(-1===u(d,c=a.attributes.Name))d.push(c),b[c]={};b[c].route=a});f(t,function(a){w=a.attributes;if(-1===u(d,c=w.RouteName||"esri.tasks.RouteTask.NULL_ROUTE_NAME"))d.push(c),b[c]={};"esri.tasks.RouteTask.NULL_ROUTE_NAME"!==c&&(v=!1);void 0===b[c].stops&&(b[c].stops=[]);b[c].stops.push(a)});0<t.length&&
!0===v&&(b[d[0]].stops=b["esri.tasks.RouteTask.NULL_ROUTE_NAME"].stops,delete b["esri.tasks.RouteTask.NULL_ROUTE_NAME"],d.splice(m.indexOf(d,"esri.tasks.RouteTask.NULL_ROUTE_NAME"),1));var y=[];f(d,function(a,c){b[a].routeName="esri.tasks.RouteTask.NULL_ROUTE_NAME"===a?null:a;b[a].spatialReference=x;y.push(new B(b[a]))});a=function(a){f(a,function(b,c){b.geometry&&(b.geometry.spatialReference=x);a[c]=new z(b)});return a};f(s,function(a,b){s[b]=new C(a)});var q={routeResults:y,barriers:a(g),polygonBarriers:a(n),
polylineBarriers:a(p),messages:s};this._successHandler([q],"onSolveComplete",l,k)}catch(r){this._errorHandler(r,h,k)}},solve:function(a,e,l,h){var k=h.assembly;a=this._encode(g.mixin({},this._url.query,{f:"json"},a.toJson(k&&k[0])));var d=this._handler,b=this._errorHandler;return q({url:this._url.path,content:a,callbackParamName:"callback",load:function(a,b){d(a,b,e,l,h.dfd)},error:function(a){b(a,l,h.dfd)}})},onSolveComplete:function(){}});r._createWrappers(e);n("extend-esri")&&g.setObject("tasks.RouteTask",
e,p);return e});